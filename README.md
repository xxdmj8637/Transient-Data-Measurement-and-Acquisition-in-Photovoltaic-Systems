# 光伏台区暂态数据量测与采集关键技术与应用
*Transient-Data-Measurement-and-Acquisition-in-Photovoltaic-Systems*

## 📖 项目简介
《光伏台区暂态数据量测与采集关键技术与应用》项目由国家电网总部立项，并委托实验室承担子课题《分布式光伏智能采集与数据压缩技术研究》。该子课题旨在实现光伏逆变器交流电压、电流波形的高精度采集，并开发高效的数据压缩算法。系统整体采集误差控制在0.5%以内，数据压缩率超过50%。

## ⚙️ 功能简介
本项目以**STM32** 单片机为主控核心，利用**定时器+ADC+DMA**同工作，实现光伏逆变器交流电压与电流波形的高频采集。采集后，在**MCU** 上运行基于小波硬阈值与稀疏压缩的算法，对数据进行压缩处理。压缩后的数据通过**DL/T698.45** 协议传输至通信模块，并借助**BC20** 模块通过**MQTT** 协议远程上传至云端，供实验室使用。整个系统可划分为采集端、压缩算法以及云服务器端三部分。
### 1. 采集端
- **主控芯片**： STM32F103C8T6  
- **电能采集**： **定时器+ADC+DMA** 
- **通信方式**： Quectel BC20（AT 指令）
  - Quectel BC20（**MQTT**，AT 指令）
  - 串口通信（**DL/T698.45** ）
- **采集数据类型**：电压、电流
### 2. 压缩算法
  - 将采集信号从时域转换到小波域，获得每层分解的小波系数
  - 设置阈值，将小波系数中小于阈值的部分置零
  - 保留非零系数的位置和值，实现系数编码
### 3. 云服务器端
- **平台**： 京东云  
- **组件部署**：
  - EMQX：处理 MQTT 消息收发  
  - MySQL：存储历史数据与窃电检测结果  
  - Python：运行窃电检测算法（互相关 + LSTM）  
  - 后台管理系统：用户授权、设备管理与数据可视化  

## 🔧 开发与部署说明
### 工程文件
- 采集端固件工程：`High_frequency_acquisition_RTOS_V3.0`（Keil 工程）  
- PCB 设计：`Embedded-System-for-PV-Inverter-Waveform-Acquisition.eprj`（嘉立创 EDA 专业版）   
### 云服务器配置
- Python 3.8+
- MySQL  5.7.42
- EMQX   5.6.1
- 推荐环境：Ubuntu 20.04 LTS
